<!DOCTYPE html>
<html lang="en" data-theme="breeze">
<head>
  <meta charset="UTF-8" />
  <title>Study Planner – Account</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#2f62f4" />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5073064276683221"
     crossorigin="anonymous"></script>
  <script>
    (function() {
      try {
        const adsDisabled = localStorage.getItem("studyAdsDisabled_v1") === "1";
        if (adsDisabled) document.documentElement.classList.add("ads-disabled");
      } catch (e) {}
    })();
  </script>
  <script>
    (function() {
      try {
        const savedTheme = localStorage.getItem("studyTheme_v1");
        if (savedTheme) {
          document.documentElement.setAttribute("data-theme", savedTheme);
        }
      } catch (e) {}
    })();
  </script>
  <link rel="manifest" href="/manifest.webmanifest" />
  <link rel="icon" href="/icons/icon-192.png" type="image/png" sizes="192x192" />
  <link rel="icon" href="/icons/app-icon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
  <script defer src="/pwa.js"></script>
  <link rel="stylesheet" href="./src/styles/main.css" />
  <link rel="stylesheet" href="./src/styles/mobile.css" />
  <link rel="stylesheet" href="./src/styles/ipad.css" />
  <link rel="stylesheet" href="./src/styles/phone-menu.css" />
  <link rel="stylesheet" href="./src/styles/phone-modals.css" />
  <link rel="stylesheet" href="./src/styles/a11y.css" />
  <link rel="stylesheet" href="./src/styles/enhancements.css" />
  <link rel="stylesheet" href="./src/styles/account.css" />
  <link rel="stylesheet" href="./src/styles/res-1024x768.css" />
  <link rel="stylesheet" href="./src/styles/res-1200x800.css" />
  <link rel="stylesheet" href="./src/styles/res-1280x720.css" />
  <link rel="stylesheet" href="./src/styles/res-1365x800.css" />
  <link rel="stylesheet" href="./src/styles/res-1366x768.css" />
  <link rel="stylesheet" href="./src/styles/res-1440x900.css" />
  <link rel="stylesheet" href="./src/styles/res-1536x864.css" />
  <link rel="stylesheet" href="./src/styles/res-1600x900.css" />
  <link rel="stylesheet" href="./src/styles/res-1680x1050.css" />
  <link rel="stylesheet" href="./src/styles/res-1920x1080.css" />
  <link rel="stylesheet" href="./src/styles/res-1920x1200.css" />
  <link rel="stylesheet" href="./src/styles/res-2560x1080.css" />
  <link rel="stylesheet" href="./src/styles/res-2560x1440.css" />
  <link rel="stylesheet" href="./src/styles/res-2560x1600.css" />
  <link rel="stylesheet" href="./src/styles/res-3440x1440.css" />
  <link rel="stylesheet" href="./src/styles/res-5120x1440.css" />
</head>
<body class="account-page-body">
  <div class="account-shell">
    <header class="account-appbar">
      <div class="account-appbar-left">
        <a class="account-back" href="./index.html">Back to app</a>
      </div>
      <div class="account-appbar-title">
        <div class="account-title">Account & sync</div>
        <div class="account-subtitle">Manage sign-in, security, and device backups.</div>
      </div>
      <div class="account-appbar-right">
        <div class="pill" id="authPill">
          <span class="pill-dot" id="authDot"></span>
          <span id="authPillText">Checking session…</span>
        </div>
        <div class="header-menu" aria-label="Menu">
          <button class="header-menu-toggle" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Open menu">...</button>
          <div class="header-menu-panel">
            <div class="header-menu-group">
              <div class="header-menu-subtitle">Pages</div>
              <a class="header-menu-link" href="./index.html?mode=board">Board</a>
              <a class="header-menu-link" href="./index.html?mode=subjects">Subjects</a>
              <a class="header-menu-link" href="./index.html?mode=today">Today's focus</a>
              <a class="header-menu-link" href="./index.html?mode=schedule">Daily schedule</a>
            </div>
            <div class="header-menu-divider"></div>
            <div class="header-menu-group">
              <div class="header-menu-subtitle">Study hubs</div>
              <a class="header-menu-link" href="./calendar.html">Calendar</a>
              <a class="header-menu-link" href="./account.html">Account</a>
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="account-layout">
      <aside class="account-sidebar">
        <div class="account-nav-label">Quick links</div>
        <nav class="account-nav" aria-label="Account sections">
          <a class="account-nav-link" href="#overview">Overview</a>
          <a class="account-nav-link" href="#login">Login / Register</a>
          <a class="account-nav-link" href="#security">Security</a>
          <a class="account-nav-link" href="#verification">Email verification</a>
          <a class="account-nav-link" href="#backups">Backups</a>
        </nav>
      </aside>

      <main class="account-content">
        <section class="account-section" id="overview">
          <div class="section-head">
            <h2>Overview</h2>
            <p>Your account status and the most important actions.</p>
          </div>
          <div class="account-card account-overview-card">
            <div class="account-overview-left">
              <div class="account-avatar" id="accountAvatar">?</div>
              <div class="account-overview-meta">
                <div class="account-overview-title" id="accountEmailValue">Not signed in</div>
                <div class="account-overview-sub" id="accountVerifyValue">Signed out</div>
              </div>
            </div>
            <div class="account-overview-actions">
              <button class="account-btn account-btn-secondary" id="accountCopyEmailBtn" type="button">Copy email</button>
              <button class="account-btn account-btn-primary" id="accountSyncNowBtn" type="button">
                <span class="btn-label">Sync now</span>
                <span class="btn-spinner" aria-hidden="true"></span>
              </button>
              <button class="account-btn account-btn-danger" id="accountLogoutBtn" type="button">Logout</button>
            </div>
          </div>
          <div class="account-meta-grid">
            <div class="account-meta-card">
              <div class="account-meta-label">Last sync</div>
              <div class="account-meta-value" id="accountLastSyncValue">—</div>
            </div>
            <div class="account-meta-card">
              <div class="account-meta-label">Last backup</div>
              <div class="account-meta-value" id="lastBackupValue">—</div>
            </div>
          </div>
          <div class="account-msg" id="accountStatusMsg" aria-live="polite"></div>
        </section>

        <section class="account-section" id="login">
          <div class="section-head">
            <h2>Login / Register</h2>
            <p>Sign in to sync your study data between devices.</p>
          </div>
          <div class="account-card" id="authCard">
            <div class="account-form">
              <div class="form-grid">
                <div class="form-field">
                  <label for="authEmail">Email</label>
                  <input class="account-input" id="authEmail" type="email" placeholder="you@example.com" autocomplete="email" />
                  <div class="field-hint" id="authEmailHint">Use the same email on all devices.</div>
                </div>
                <div class="form-field">
                  <label for="authPassword">Password</label>
                  <div class="input-with-toggle">
                    <input class="account-input" id="authPassword" type="password" placeholder="Minimum 8 characters" autocomplete="current-password" />
                    <button class="field-toggle" type="button" data-toggle-target="authPassword" aria-pressed="false">Show</button>
                  </div>
                  <div class="field-hint" id="authPasswordHint">Password must be at least 8 characters.</div>
                </div>
              </div>
              <div class="account-row">
                <button class="account-btn account-btn-primary" id="loginBtn" type="button">Login</button>
                <button class="account-btn account-btn-secondary" id="registerBtn" type="button">Register</button>
              </div>
            </div>
            <div class="account-msg" id="authMsg" aria-live="polite"></div>
            <div class="account-tip">
              Tip: Registering uploads your current local data to your new account automatically.
            </div>
          </div>
        </section>

        <section class="account-section" id="security">
          <div class="section-head">
            <h2>Security</h2>
            <p>Update your password and manage advanced recovery options.</p>
          </div>
          <div class="account-card">
            <div class="account-form">
              <div class="form-grid">
                <div class="form-field">
                  <label for="currentPassword">Current password</label>
                  <div class="input-with-toggle">
                    <input class="account-input" id="currentPassword" type="password" placeholder="Current password" autocomplete="current-password" />
                    <button class="field-toggle" type="button" data-toggle-target="currentPassword" aria-pressed="false">Show</button>
                  </div>
                </div>
                <div class="form-field">
                  <label for="newPassword">New password</label>
                  <div class="input-with-toggle">
                    <input class="account-input" id="newPassword" type="password" placeholder="Minimum 8 characters" autocomplete="new-password" />
                    <button class="field-toggle" type="button" data-toggle-target="newPassword" aria-pressed="false">Show</button>
                  </div>
                  <div class="field-hint" id="newPasswordHint">Use at least 8 characters.</div>
                </div>
              </div>
              <div class="account-row">
                <button class="account-btn account-btn-primary" id="changePasswordBtn" type="button">Change password</button>
              </div>
            </div>
            <div class="account-msg" id="changePasswordMsg" aria-live="polite"></div>
          </div>

          <details class="account-details">
            <summary>Advanced: Password reset</summary>
            <div class="account-card account-card-inline">
              <div class="account-form">
                <div class="form-grid">
                  <div class="form-field">
                    <label for="resetEmail">Account email</label>
                    <input class="account-input" id="resetEmail" type="email" placeholder="you@example.com" autocomplete="email" />
                  </div>
                  <div class="form-field">
                    <label>&nbsp;</label>
                    <button class="account-btn account-btn-secondary" id="requestResetBtn" type="button">Request reset token</button>
                  </div>
                  <div class="form-field">
                    <label for="resetToken">Reset token</label>
                    <input class="account-input" id="resetToken" type="text" placeholder="Paste reset token" />
                  </div>
                  <div class="form-field">
                    <label for="resetNewPassword">New password</label>
                    <div class="input-with-toggle">
                      <input class="account-input" id="resetNewPassword" type="password" placeholder="Minimum 8 characters" autocomplete="new-password" />
                      <button class="field-toggle" type="button" data-toggle-target="resetNewPassword" aria-pressed="false">Show</button>
                    </div>
                  </div>
                </div>
                <div class="account-row">
                  <button class="account-btn account-btn-primary" id="resetPasswordBtn" type="button">Reset password</button>
                </div>
              </div>
              <div class="account-msg" id="resetMsg" aria-live="polite"></div>
            </div>
          </details>
        </section>

	        <section class="account-section" id="verification">
	          <div class="section-head">
	            <h2>Email verification</h2>
	            <p>Verify your email to secure your account.</p>
	          </div>
	          <div class="account-card">
	            <div class="account-row">
	              <button class="account-btn account-btn-primary" id="requestVerifyBtn" type="button">Send verification code</button>
	            </div>
	            <details class="account-details account-details-inline">
	              <summary>Have a code? Enter it here</summary>
	              <div class="account-form">
	                <div class="form-grid">
	                  <div class="form-field">
	                    <label for="verifyToken">Verification code</label>
	                    <input class="account-input" id="verifyToken" type="text" inputmode="numeric" autocomplete="one-time-code" placeholder="Enter 6-digit code" />
	                  </div>
	                  <div class="form-field">
	                    <label>&nbsp;</label>
	                    <button class="account-btn account-btn-primary" id="verifyEmailBtn" type="button">Verify email</button>
	                  </div>
                </div>
              </div>
            </details>
            <div class="account-msg" id="verifyMsg" aria-live="polite"></div>
          </div>
        </section>

        <section class="account-section" id="backups">
          <div class="section-head">
            <h2>Backups</h2>
            <p>Restoring a backup replaces local data on this device. Your account data remains safe.</p>
          </div>
          <div class="account-card">
            <div class="account-row account-row-between">
              <div class="account-row">
                <button class="account-btn account-btn-secondary" id="refreshVersionsBtn" type="button">Refresh list</button>
                <div class="field-inline">
                  <label for="versionsFilter" class="sr-only">Filter backups</label>
                  <input class="account-input" id="versionsFilter" type="text" placeholder="Filter by ID or date" />
                </div>
              </div>
            </div>
            <ul class="account-list" id="versionsList"></ul>
            <div class="account-msg" id="versionsMsg" aria-live="polite"></div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <div class="account-modal-backdrop" id="restoreConfirmBackdrop" hidden>
    <div class="account-modal" role="dialog" aria-modal="true" aria-labelledby="restoreConfirmTitle">
      <div class="account-modal-head">
        <div>
          <div class="account-modal-title" id="restoreConfirmTitle">Restore backup?</div>
          <div class="account-modal-subtitle" id="restoreConfirmBody"></div>
        </div>
        <button class="icon-btn" id="restoreConfirmCloseBtn" type="button" aria-label="Close">✕</button>
      </div>
      <div class="account-modal-actions">
        <button class="account-btn account-btn-secondary" id="restoreConfirmCancelBtn" type="button">Cancel</button>
        <button class="account-btn account-btn-danger" id="restoreConfirmConfirmBtn" type="button">
          <span class="btn-label">Restore</span>
          <span class="btn-spinner" aria-hidden="true"></span>
        </button>
      </div>
    </div>
  </div>

  <div class="toast-stack" id="toastStack" aria-live="polite" aria-atomic="false"></div>

  <script src="./src/storage.js" defer></script>
  <script src="./src/a11y-utils.js" defer></script>
  <script src="./src/sync.js" defer></script>
  <script src="./src/page-menu.js" defer></script>
  <script src="./src/account.js" defer></script>
</body>
</html>
